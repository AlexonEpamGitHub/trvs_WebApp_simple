<?xml version="1.0"?>

<!-- For more information on using Web.config transformation visit https://go.microsoft.com/fwlink/?LinkId=301874 -->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <system.web>
    <compilation xdt:Transform="RemoveAttributes(debug)" />
    
    <!-- Enhanced error handling with secure custom error configuration -->
    <customErrors mode="On" xdt:Transform="Replace">
      <error statusCode="500" redirect="InternalServerError.html"/>
      <error statusCode="404" redirect="PageNotFound.html"/>
      <error statusCode="403" redirect="AccessDenied.html"/>
    </customErrors>
  </system.web>

  <system.webServer>
    <httpProtocol>
      <customHeaders>
        <!-- Add security-related HTTP headers -->
        <add name="X-Content-Type-Options" value="nosniff" xdt:Transform="Insert"/>
        <add name="X-Frame-Options" value="DENY" xdt:Transform="Insert"/>
        <add name="X-XSS-Protection" value="1; mode=block" xdt:Transform="Insert"/>
        <add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains" xdt:Transform="Insert"/>
        <add name="Cache-Control" value="no-store, no-cache, must-revalidate" xdt:Transform="Insert"/>
        <add name="Pragma" value="no-cache" xdt:Transform="Insert"/>
      </customHeaders>
    </httpProtocol>

    <!-- Improve error handling configuration at the server level -->
    <httpErrors errorMode="Custom" existingResponse="Replace" xdt:Transform="Replace">
      <remove statusCode="404" subStatusCode="-1" xdt:Transform="Remove"/>
      <remove statusCode="500" subStatusCode="-1" xdt:Transform="Remove"/>
      <error statusCode="404" path="/PageNotFound.html" responseMode="ExecuteURL" />
      <error statusCode="500" path="/InternalServerError.html" responseMode="ExecuteURL" />
      <error statusCode="403" path="/AccessDenied.html" responseMode="ExecuteURL" />
    </httpErrors>
  </system.webServer>
</configuration>